{"ast":null,"code":"import _objectSpread from\"/Users/newsilver/Project/react-study-7-weeks/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{createSlice}from'@reduxjs/toolkit';export var initialState={discounts:[],totalPrices:0,excludedPrices:0,storedFoods:[]};export var discountReducer=createSlice({name:'discountReducer',initialState:initialState,reducers:{STORE:function STORE(state,_ref){var payload=_ref.payload;var data=payload.discounts;state.discounts=data.map(function(discount){return _objectSpread(_objectSpread({},discount),{},{discountedMenu:[],excludedPrices:0,totalPrices:0,isSelected:true});});},UPDATE:function UPDATE(state,_ref2){var payload=_ref2.payload;state.storedFoods=payload;state.discounts=state.discounts.map(function(discount){discount.discountedMenu=payload.map(function(food){var discountedPrice=getDiscountedPrice(food.priceTimesQuantity,discount.discount_rate);var excludedPrice=getExcludedPrice(food.priceTimesQuantity,discountedPrice);return{name:food.name,quantity:food.quantity,prices:food.priceTimesQuantity,discountedPrices:discountedPrice,excludedPrices:excludedPrice,totalPrices:0};});return discount;});},ADD:function ADD(state,_ref3){var payload=_ref3.payload;state.storedFoods=payload;state.discounts=state.discounts.map(function(discount){payload.forEach(function(food){var discountedPrice=getDiscountedPrice(food.priceTimesQuantity,discount.discount_rate);var excludedPrice=getExcludedPrice(food.priceTimesQuantity,discountedPrice);var menuObject={name:food.name,discountedPrices:discountedPrice,excludedPrices:excludedPrice};discount.discountedMenu.push(menuObject);});return discount;});},SELECT_DISCOUNTS:function SELECT_DISCOUNTS(state,_ref4){var payload=_ref4.payload;state.discounts.map(function(discount){if(discount.name===payload){discount.isSelected=!discount.isSelected;}return discount;});},SELECT_MENU:function SELECT_MENU(state,_ref5){var payload=_ref5.payload;state.discounts.map(function(discount){discount.discountedPrices=0;discount.discountedMenu.map(function(menu){if(menu.name===payload){menu.isSelected=!menu.isSelected;}});});},COMPUTE_PRICE:function COMPUTE_PRICE(state){state.totalPrices=0;state.totalPrices=state.storedFoods.reduce(function(prev,current){return prev+current.priceTimesQuantity;},0);state.discounts=state.discounts.map(function(discount){discount.discountedMenu=discount.discountedMenu.map(function(menu){if(menu.isSelected){discount.excludedPrices+=menu.excludedPrices;}return menu;});if(discount.isSelected){state.totalPrices-=discount.excludedPrices;}return discount;});console.log(\"total\",state.totalPrices);}}});function getDiscountedPrice(price,rate){return Math.floor((100-rate)*0.01*price);}function getExcludedPrice(totalPrice,discountedPrice){return Math.floor(totalPrice-discountedPrice);}","map":{"version":3,"sources":["/Users/newsilver/Project/react-study-7-weeks/src/Reducers/discountReducer.ts"],"names":["createSlice","initialState","discounts","totalPrices","excludedPrices","storedFoods","discountReducer","name","reducers","STORE","state","payload","data","map","discount","discountedMenu","isSelected","UPDATE","food","discountedPrice","getDiscountedPrice","priceTimesQuantity","discount_rate","excludedPrice","getExcludedPrice","quantity","prices","discountedPrices","ADD","forEach","menuObject","push","SELECT_DISCOUNTS","SELECT_MENU","menu","COMPUTE_PRICE","reduce","prev","current","console","log","price","rate","Math","floor","totalPrice"],"mappings":"iIAAA,OAASA,WAAT,KAA2C,kBAA3C,CAKA,MAAO,IAAMC,CAAAA,YAAY,CAAG,CAC1BC,SAAS,CAAE,EADe,CAE1BC,WAAW,CAAE,CAFa,CAG1BC,cAAc,CAAE,CAHU,CAI1BC,WAAW,CAAE,EAJa,CAArB,CAOP,MAAO,IAAMC,CAAAA,eAAe,CAAGN,WAAW,CAAC,CACzCO,IAAI,CAAE,iBADmC,CAEzCN,YAAY,CAAEA,YAF2B,CAGzCO,QAAQ,CAAE,CACRC,KAAK,CAAE,eAACC,KAAD,MAAiD,IAAvCC,CAAAA,OAAuC,MAAvCA,OAAuC,CACtD,GAAMC,CAAAA,IAAI,CAAGD,OAAO,CAACT,SAArB,CACAQ,KAAK,CAACR,SAAN,CAAkBU,IAAI,CAACC,GAAL,CAAS,SAACC,QAAD,CAAyB,CAClD,sCACKA,QADL,MAEEC,cAAc,CAAE,EAFlB,CAGEX,cAAc,CAAE,CAHlB,CAIED,WAAW,CAAC,CAJd,CAKEa,UAAU,CAAE,IALd,GAOD,CARiB,CAAlB,CASD,CAZO,CAaRC,MAAM,CAAE,gBAACP,KAAD,OAAsD,IAA5CC,CAAAA,OAA4C,OAA5CA,OAA4C,CAC5DD,KAAK,CAACL,WAAN,CAAoBM,OAApB,CACAD,KAAK,CAACR,SAAN,CAAkBQ,KAAK,CAACR,SAAN,CAAgBW,GAAhB,CAAoB,SAACC,QAAD,CAAc,CAClDA,QAAQ,CAACC,cAAT,CAA0BJ,OAAO,CAACE,GAAR,CAAY,SAAAK,IAAI,CAAI,CAC5C,GAAMC,CAAAA,eAAe,CAAGC,kBAAkB,CAACF,IAAI,CAACG,kBAAN,CAAyBP,QAAQ,CAACQ,aAAlC,CAA1C,CACA,GAAMC,CAAAA,aAAa,CAAGC,gBAAgB,CAACN,IAAI,CAACG,kBAAN,CAA0BF,eAA1B,CAAtC,CACA,MAAO,CACLZ,IAAI,CAAEW,IAAI,CAACX,IADN,CAELkB,QAAQ,CAAEP,IAAI,CAACO,QAFV,CAGLC,MAAM,CAAER,IAAI,CAACG,kBAHR,CAILM,gBAAgB,CAAER,eAJb,CAKLf,cAAc,CAAEmB,aALX,CAMLpB,WAAW,CAAE,CANR,CAAP,CAQD,CAXyB,CAA1B,CAYA,MAAOW,CAAAA,QAAP,CACD,CAdiB,CAAlB,CAeD,CA9BO,CA+BRc,GAAG,CAAE,aAAClB,KAAD,OAAsD,IAA5CC,CAAAA,OAA4C,OAA5CA,OAA4C,CACzDD,KAAK,CAACL,WAAN,CAAoBM,OAApB,CACAD,KAAK,CAACR,SAAN,CAAkBQ,KAAK,CAACR,SAAN,CAAgBW,GAAhB,CAAoB,SAACC,QAAD,CAAc,CAClDH,OAAO,CAACkB,OAAR,CAAgB,SAACX,IAAD,CAAU,CACxB,GAAMC,CAAAA,eAAe,CAAGC,kBAAkB,CAACF,IAAI,CAACG,kBAAN,CAAyBP,QAAQ,CAACQ,aAAlC,CAA1C,CACA,GAAMC,CAAAA,aAAa,CAAGC,gBAAgB,CAACN,IAAI,CAACG,kBAAN,CAA0BF,eAA1B,CAAtC,CACA,GAAMW,CAAAA,UAAU,CAAG,CACjBvB,IAAI,CAAEW,IAAI,CAACX,IADM,CAEjBoB,gBAAgB,CAAER,eAFD,CAGjBf,cAAc,CAAEmB,aAHC,CAAnB,CAKAT,QAAQ,CAACC,cAAT,CAAyBgB,IAAzB,CAA8BD,UAA9B,EACD,CATD,EAUA,MAAOhB,CAAAA,QAAP,CACD,CAZiB,CAAlB,CAaD,CA9CO,CA+CRkB,gBAAgB,CAAE,0BAACtB,KAAD,OAA+C,IAArCC,CAAAA,OAAqC,OAArCA,OAAqC,CAC/DD,KAAK,CAACR,SAAN,CAAgBW,GAAhB,CAAoB,SAACC,QAAD,CAAc,CAChC,GAAGA,QAAQ,CAACP,IAAT,GAAkBI,OAArB,CAA8B,CAC5BG,QAAQ,CAACE,UAAT,CAAsB,CAACF,QAAQ,CAACE,UAAhC,CACD,CACD,MAAOF,CAAAA,QAAP,CACD,CALD,EAMD,CAtDO,CAuDRmB,WAAW,CAAE,qBAACvB,KAAD,OAA+C,IAArCC,CAAAA,OAAqC,OAArCA,OAAqC,CAC1DD,KAAK,CAACR,SAAN,CAAgBW,GAAhB,CAAoB,SAACC,QAAD,CAAc,CAChCA,QAAQ,CAACa,gBAAT,CAA2B,CAA3B,CACAb,QAAQ,CAACC,cAAT,CAAyBF,GAAzB,CAA6B,SAACqB,IAAD,CAAU,CACrC,GAAGA,IAAI,CAAC3B,IAAL,GAAcI,OAAjB,CAA0B,CACxBuB,IAAI,CAAClB,UAAL,CAAkB,CAACkB,IAAI,CAAClB,UAAxB,CACD,CACF,CAJD,EAKD,CAPD,EAQD,CAhEO,CAiERmB,aAAa,CAAE,uBAACzB,KAAD,CAAW,CACxBA,KAAK,CAACP,WAAN,CAAoB,CAApB,CACAO,KAAK,CAACP,WAAN,CAAqBO,KAAK,CAACL,WAAN,CAAmB+B,MAAnB,CAA2B,SAACC,IAAD,CAAOC,OAAP,QAAmBD,CAAAA,IAAI,CAAGC,OAAO,CAACjB,kBAAlC,EAA3B,CAAiF,CAAjF,CAArB,CACAX,KAAK,CAACR,SAAN,CAAkBQ,KAAK,CAACR,SAAN,CAAgBW,GAAhB,CAAoB,SAACC,QAAD,CAAc,CAClDA,QAAQ,CAACC,cAAT,CAA2BD,QAAQ,CAACC,cAAT,CAAyBF,GAAzB,CAA6B,SAACqB,IAAD,CAAU,CAChE,GAAGA,IAAI,CAAClB,UAAR,CAAoB,CAClBF,QAAQ,CAACV,cAAT,EAA4B8B,IAAI,CAAC9B,cAAjC,CACD,CACD,MAAO8B,CAAAA,IAAP,CACD,CAL0B,CAA3B,CAMA,GAAGpB,QAAQ,CAACE,UAAZ,CAAwB,CACtBN,KAAK,CAACP,WAAN,EAAsBW,QAAQ,CAACV,cAA/B,CACD,CACD,MAAOU,CAAAA,QAAP,CACD,CAXiB,CAAlB,CAYAyB,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAoB9B,KAAK,CAACP,WAA1B,EACD,CAjFO,CAH+B,CAAD,CAAnC,CAwFP,QAASiB,CAAAA,kBAAT,CAA4BqB,KAA5B,CAA2CC,IAA3C,CAAiE,CAC/D,MAAOC,CAAAA,IAAI,CAACC,KAAL,CAAW,CAAC,IAAMF,IAAP,EAAe,IAAf,CAAsBD,KAAjC,CAAP,CACD,CAED,QAASjB,CAAAA,gBAAT,CAA0BqB,UAA1B,CAA8C1B,eAA9C,CAA+E,CAC7E,MAAOwB,CAAAA,IAAI,CAACC,KAAL,CAAWC,UAAU,CAAG1B,eAAxB,CAAP,CACD","sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nimport { DiscountsData, Discounts } from '../Interface/discountInterface'\nimport { FoodData, StoredFoods } from '../Interface/cartInterface';\n\nexport const initialState = {\n  discounts: [],\n  totalPrices: 0,\n  excludedPrices: 0,\n  storedFoods: []\n}\n\nexport const discountReducer = createSlice({\n  name: 'discountReducer',\n  initialState: initialState as DiscountsData,\n  reducers: {\n    STORE: (state, { payload }: PayloadAction<FoodData>) => {\n      const data = payload.discounts;\n      state.discounts = data.map((discount: Discounts) => {\n        return {\n          ...discount,\n          discountedMenu: [],\n          excludedPrices: 0,\n          totalPrices:0,\n          isSelected: true\n        }\n      })\n    },\n    UPDATE: (state, { payload }: PayloadAction<StoredFoods[]>) => {\n      state.storedFoods = payload;\n      state.discounts = state.discounts.map((discount) => {\n        discount.discountedMenu = payload.map(food => {\n          const discountedPrice = getDiscountedPrice(food.priceTimesQuantity,discount.discount_rate);\n          const excludedPrice = getExcludedPrice(food.priceTimesQuantity, discountedPrice);\n          return {\n            name: food.name,\n            quantity: food.quantity,\n            prices: food.priceTimesQuantity,\n            discountedPrices: discountedPrice,\n            excludedPrices: excludedPrice,\n            totalPrices: 0\n          }\n        });\n        return discount;\n      })\n    },\n    ADD: (state, { payload }: PayloadAction<StoredFoods[]>) => {\n      state.storedFoods = payload;\n      state.discounts = state.discounts.map((discount) => {\n        payload.forEach((food) => {\n          const discountedPrice = getDiscountedPrice(food.priceTimesQuantity,discount.discount_rate);\n          const excludedPrice = getExcludedPrice(food.priceTimesQuantity, discountedPrice);\n          const menuObject = {\n            name: food.name,\n            discountedPrices: discountedPrice,\n            excludedPrices: excludedPrice\n          }\n          discount.discountedMenu!.push(menuObject);   \n        });\n        return discount;\n      })\n    },\n    SELECT_DISCOUNTS: (state, { payload }: PayloadAction<string>) => {\n      state.discounts.map((discount) => {\n        if(discount.name === payload) {\n          discount.isSelected = !discount.isSelected;\n        }\n        return discount;\n      });\n    },\n    SELECT_MENU: (state, { payload }: PayloadAction<string>) => {\n      state.discounts.map((discount) => {\n        discount.discountedPrices= 0;\n        discount.discountedMenu!.map((menu) => {\n          if(menu.name === payload) {\n            menu.isSelected = !menu.isSelected;\n          }\n        })\n      })\n    },\n    COMPUTE_PRICE: (state) => {\n      state.totalPrices = 0;\n      state.totalPrices! = state.storedFoods!.reduce(((prev, current) => prev + current.priceTimesQuantity),0);\n      state.discounts = state.discounts.map((discount) => {\n        discount.discountedMenu! = discount.discountedMenu!.map((menu) => {\n          if(menu.isSelected) {\n            discount.excludedPrices! += menu.excludedPrices;\n          }\n          return menu;\n        });\n        if(discount.isSelected) {\n          state.totalPrices! -= discount.excludedPrices!;\n        }\n        return discount;\n      });\n      console.log(\"total\",state.totalPrices);\n    }\n  }\n});\n\nfunction getDiscountedPrice(price: number, rate: number): number {\n  return Math.floor((100 - rate) * 0.01 * price);\n}\n\nfunction getExcludedPrice(totalPrice: number, discountedPrice: number): number {\n  return Math.floor(totalPrice - discountedPrice);\n}\n"]},"metadata":{},"sourceType":"module"}